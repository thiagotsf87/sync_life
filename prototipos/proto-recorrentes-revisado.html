<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SyncLife ‚Äî Transa√ß√µes Recorrentes</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#03071a;--s1:#07112b;--s2:#0c1a3a;--s3:#132248;
  --border:rgba(255,255,255,0.06);--border-h:rgba(255,255,255,0.13);
  --t1:#dff0ff;--t2:#6e90b8;--t3:#2e4a6e;
  --em:#10b981;--el:#0055ff;
  --green:#10b981;--yellow:#f59e0b;--orange:#f97316;--red:#f43f5e;--purple:#8b5cf6;
}
body.jornada{--bg:#020d08;--s1:#061410;--s2:#0b1e18;--s3:#112b22;--border:rgba(16,185,129,0.08);--border-h:rgba(16,185,129,0.18);--t1:#d6faf0;--t2:#4da888;--t3:#235c48}
body.light{--bg:#e6eef5;--s1:#ffffff;--s2:#f0f6fa;--s3:#e0eaf3;--border:rgba(3,7,26,0.09);--border-h:rgba(3,7,26,0.18);--t1:#03071a;--t2:#1e3a5c;--t3:#5a7a9e}
body.light.jornada{--bg:#c8f0e4;--s1:#ffffff;--s2:#e0f7ef;--s3:#c4eede;--border:rgba(5,80,56,0.12);--border-h:rgba(5,80,56,0.24);--t1:#022016;--t2:#0d5c3e;--t3:#4da888}
html,body{height:100%;min-height:100vh}
body{font-family:"DM Sans",sans-serif;background:var(--bg);color:var(--t1);font-size:14px;line-height:1.5;transition:background .35s,color .25s}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--s3);border-radius:2px}
input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}
input[type=number]{-moz-appearance:textfield;appearance:textfield}

/* ‚îÄ‚îÄ DEV BAR ‚îÄ‚îÄ */
.dev-bar{position:fixed;top:0;left:0;right:0;z-index:200;background:rgba(3,7,26,.95);border-bottom:1px solid rgba(255,255,255,0.08);backdrop-filter:blur(12px);display:flex;align-items:center;gap:8px;padding:8px 20px;font-size:11px;color:#6e90b8}
.dev-bar strong{color:#dff0ff;margin-right:4px}
.dev-pill{padding:4px 10px;border-radius:100px;border:1px solid rgba(255,255,255,0.1);background:none;color:#6e90b8;cursor:pointer;font-size:11px;transition:all .15s;font-family:"DM Sans",sans-serif}
.dev-pill:hover{border-color:rgba(255,255,255,0.25);color:#dff0ff}
.dev-pill.on{background:var(--em);color:#03071a;border-color:transparent;font-weight:700}
.dev-sep{width:1px;height:16px;background:rgba(255,255,255,0.1);margin:0 4px}
body.light .dev-bar{background:rgba(230,237,245,.97);border-color:rgba(0,0,0,.08);color:#1e3a5c}
body.light .dev-pill{color:#1e3a5c;border-color:rgba(0,0,0,.15)}

/* ‚îÄ‚îÄ PAGE ‚îÄ‚îÄ */
.page{max-width:960px;margin:0 auto;padding:32px 24px 80px;margin-top:48px}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
.page-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:24px;gap:16px}
.page-eyebrow{font-size:11px;color:var(--em);font-weight:700;text-transform:uppercase;letter-spacing:.07em;margin-bottom:4px}
.page-title{font-family:"Syne",sans-serif;font-size:24px;font-weight:800;color:var(--t1);letter-spacing:-.02em}
.page-sub{font-size:13px;color:var(--t2);margin-top:3px}
.btn-new{display:inline-flex;align-items:center;gap:7px;background:var(--em);color:#03071a;font-family:"DM Sans",sans-serif;font-weight:700;font-size:13px;padding:10px 20px;border-radius:100px;border:none;cursor:pointer;transition:all .2s;box-shadow:0 4px 16px rgba(16,185,129,.25);white-space:nowrap;flex-shrink:0}
.btn-new:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(16,185,129,.35);filter:brightness(1.06)}

/* ‚îÄ‚îÄ FREE LIMIT BANNER ‚îÄ‚îÄ */
.free-banner{display:flex;align-items:center;gap:12px;background:rgba(139,92,246,.06);border:1px solid rgba(139,92,246,.2);border-radius:12px;padding:14px 18px;margin-bottom:20px}
.free-banner-icon{font-size:20px;flex-shrink:0}
.free-banner-body{flex:1}
.free-banner-title{font-size:13px;font-weight:600;color:var(--t1);margin-bottom:2px}
.free-banner-desc{font-size:12px;color:var(--t2)}
.free-banner-cta{font-size:12px;font-weight:700;padding:6px 14px;border-radius:100px;background:rgba(139,92,246,.15);border:1px solid rgba(139,92,246,.3);color:#a78bfa;cursor:pointer;white-space:nowrap;transition:all .15s;font-family:"DM Sans",sans-serif}
.free-banner-cta:hover{background:rgba(139,92,246,.25)}

/* ‚îÄ‚îÄ SUMMARY STRIP ‚îÄ‚îÄ */
.summary-strip{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:24px}
.sum-card{background:var(--s1);border:1px solid var(--border);border-radius:14px;padding:16px 18px}
.sum-label{font-size:11px;color:var(--t3);text-transform:uppercase;letter-spacing:.06em;margin-bottom:4px}
.sum-value{font-family:"DM Mono",monospace;font-size:18px;font-weight:500;color:var(--t1)}
.sum-value.red{color:var(--red)}.sum-value.green{color:var(--green)}
.sum-sub{font-size:11px;color:var(--t3);margin-top:3px}

/* ‚îÄ‚îÄ JORNADA INSIGHT ‚îÄ‚îÄ */
.jornada-insight{display:none;background:rgba(16,185,129,.06);border:1px solid rgba(16,185,129,.15);border-radius:14px;padding:14px 18px;margin-bottom:20px;gap:12px;align-items:flex-start}
body.jornada .jornada-insight{display:flex}
.ji-icon{font-size:20px;flex-shrink:0;margin-top:1px}
.ji-text{font-size:13px;color:var(--t2);line-height:1.6}
.ji-text strong{color:var(--t1)}

/* ‚îÄ‚îÄ SE√á√ïES ‚îÄ‚îÄ */
.section{margin-bottom:28px}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.section-label{display:flex;align-items:center;gap:8px}
.section-title{font-family:"Syne",sans-serif;font-size:13px;font-weight:700;color:var(--t2);text-transform:uppercase;letter-spacing:.06em}
.section-count{font-size:11px;color:var(--t3);background:var(--s2);border:1px solid var(--border);border-radius:100px;padding:2px 8px}
.section-total{font-family:"DM Mono",monospace;font-size:13px;color:var(--t2)}

/* ‚îÄ‚îÄ RECORRENTE CARD ‚îÄ‚îÄ */
.rec-list{display:flex;flex-direction:column;gap:8px}
.rec-card{background:var(--s1);border:1px solid var(--border);border-radius:14px;padding:16px 18px;transition:border-color .2s;position:relative}
.rec-card:hover{border-color:var(--border-h)}
.rec-card.paused{opacity:.55}
.rec-card.paused .rec-name{text-decoration:line-through;opacity:.7}

.rec-main{display:flex;align-items:center;gap:12px}
.rec-icon-wrap{width:40px;height:40px;border-radius:11px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.rec-body{flex:1;min-width:0}
.rec-name-row{display:flex;align-items:center;gap:8px;margin-bottom:2px}
.rec-name{font-size:14px;font-weight:600;color:var(--t1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rec-badge{font-size:10px;font-weight:700;padding:2px 7px;border-radius:100px;flex-shrink:0}
.badge-paused{background:rgba(110,144,184,.1);color:var(--t2);border:1px solid rgba(110,144,184,.2)}
.badge-expense{background:rgba(244,63,94,.1);color:var(--red);border:1px solid rgba(244,63,94,.2)}
.badge-income{background:rgba(16,185,129,.1);color:var(--green);border:1px solid rgba(16,185,129,.2)}
.rec-meta{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.rec-meta-item{display:flex;align-items:center;gap:4px;font-size:12px;color:var(--t3)}
.rec-meta-item svg{width:12px;height:12px;flex-shrink:0}

.rec-right{display:flex;align-items:center;gap:12px;flex-shrink:0}
.rec-amount{font-family:"DM Mono",monospace;font-size:16px;font-weight:500;white-space:nowrap}
.rec-amount.expense{color:var(--red)}
.rec-amount.income{color:var(--green)}

.rec-actions{display:flex;gap:4px}
.rec-btn{background:none;border:1px solid var(--border);border-radius:8px;padding:5px 10px;font-size:11px;color:var(--t3);cursor:pointer;font-family:"DM Sans",sans-serif;transition:all .15s;white-space:nowrap;display:flex;align-items:center;gap:4px}
.rec-btn:hover{border-color:var(--border-h);color:var(--t1)}
.rec-btn.pause-btn:hover{border-color:rgba(245,158,11,.4);color:var(--yellow)}
.rec-btn.delete-btn:hover{border-color:rgba(244,63,94,.4);color:var(--red)}
.rec-btn svg{width:12px;height:12px}

/* Pr√≥xima ocorr√™ncia */
.rec-next{display:flex;align-items:center;justify-content:space-between;margin-top:10px;padding-top:10px;border-top:1px solid var(--border)}
.rec-next-label{font-size:11px;color:var(--t3)}
.rec-next-date{font-size:12px;color:var(--t2);font-weight:500}
.rec-next-countdown{font-size:11px;color:var(--t3)}

/* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
.empty-state{text-align:center;padding:48px 24px;background:var(--s1);border:1px dashed var(--border);border-radius:14px}
.empty-emoji{font-size:40px;display:block;margin-bottom:12px;opacity:.7}
.empty-title{font-family:"Syne",sans-serif;font-size:16px;font-weight:700;color:var(--t1);margin-bottom:6px}
.empty-sub{font-size:13px;color:var(--t2)}

/* ‚îÄ‚îÄ PR√ìXIMAS OCORR√äNCIAS (calend√°rio mini) ‚îÄ‚îÄ */
.upcoming-card{background:var(--s1);border:1px solid var(--border);border-radius:14px;padding:18px 20px;margin-bottom:28px}
.upcoming-title{font-family:"Syne",sans-serif;font-size:13px;font-weight:700;color:var(--t2);text-transform:uppercase;letter-spacing:.06em;margin-bottom:14px}
.upcoming-list{display:flex;flex-direction:column;gap:0}
.upcoming-item{display:flex;align-items:center;gap:12px;padding:9px 0;border-bottom:1px solid var(--border)}
.upcoming-item:last-child{border-bottom:none}
.upcoming-date-col{width:44px;flex-shrink:0;text-align:center}
.upcoming-day{font-family:"DM Mono",monospace;font-size:18px;font-weight:700;color:var(--t1);line-height:1}
.upcoming-month{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.05em}
.upcoming-icon{font-size:18px;flex-shrink:0}
.upcoming-info{flex:1;min-width:0}
.upcoming-name{font-size:13px;font-weight:500;color:var(--t1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.upcoming-freq{font-size:11px;color:var(--t3)}
.upcoming-val{font-family:"DM Mono",monospace;font-size:13px;font-weight:500;white-space:nowrap}
.upcoming-val.expense{color:var(--red)}.upcoming-val.income{color:var(--green)}

/* ‚îÄ‚îÄ MODAIS ‚îÄ‚îÄ */
.modal-overlay{display:none;position:fixed;inset:0;z-index:300;background:rgba(3,7,26,.75);backdrop-filter:blur(6px);align-items:center;justify-content:center;padding:24px}
.modal-overlay.open{display:flex}
.modal{background:var(--s1);border:1px solid var(--border);border-radius:20px;width:100%;max-width:500px;max-height:90vh;display:flex;flex-direction:column;animation:modalIn .25s ease both}
@keyframes modalIn{from{opacity:0;transform:scale(.96) translateY(8px)}to{opacity:1;transform:none}}
.modal-header{padding:28px 28px 0;flex-shrink:0}
.modal-title{font-family:"Syne",sans-serif;font-size:20px;font-weight:800;color:var(--t1);letter-spacing:-.02em;margin-bottom:6px}
.modal-sub{font-size:13px;color:var(--t2);line-height:1.55}
.modal-body{padding:24px 28px;overflow-y:auto;flex:1}
.modal-footer{padding:0 28px 24px;display:flex;align-items:center;justify-content:flex-end;gap:10px;flex-shrink:0;border-top:1px solid var(--border);padding-top:16px}
.modal-field{margin-bottom:16px}
.modal-label{font-size:11px;font-weight:700;color:var(--t2);margin-bottom:6px;display:block;text-transform:uppercase;letter-spacing:.05em}
.modal-input{width:100%;background:var(--s2);border:1px solid var(--border);border-radius:10px;padding:11px 14px;font-family:"DM Sans",sans-serif;font-size:14px;color:var(--t1);outline:none;transition:border-color .2s}
.modal-input:focus{border-color:rgba(16,185,129,.45);box-shadow:0 0 0 3px rgba(16,185,129,.07)}
.modal-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}

/* Tipo despesa/receita toggle */
.type-toggle{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:16px}
.type-btn{padding:10px;border-radius:10px;border:1.5px solid var(--border);background:var(--s2);cursor:pointer;text-align:center;transition:all .2s;font-family:"DM Sans",sans-serif}
.type-btn-icon{font-size:20px;display:block;margin-bottom:4px}
.type-btn-label{font-size:12px;font-weight:600;color:var(--t2)}
.type-btn.sel-expense{border-color:var(--red);background:rgba(244,63,94,.06)}
.type-btn.sel-expense .type-btn-label{color:var(--red)}
.type-btn.sel-income{border-color:var(--green);background:rgba(16,185,129,.06)}
.type-btn.sel-income .type-btn-label{color:var(--green)}

/* Frequ√™ncia grid */
.freq-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px}
.freq-btn{padding:8px 4px;border-radius:9px;border:1.5px solid var(--border);background:var(--s2);cursor:pointer;text-align:center;font-size:11px;font-weight:600;color:var(--t2);transition:all .15s;font-family:"DM Sans",sans-serif}
.freq-btn:hover{border-color:var(--border-h);color:var(--t1)}
.freq-btn.sel{border-color:var(--em);background:rgba(16,185,129,.07);color:var(--em)}

/* Valor input com prefixo */
.val-input-wrap{display:flex;align-items:center;background:var(--s2);border:1px solid var(--border);border-radius:10px;overflow:hidden;transition:border-color .2s}
.val-input-wrap:focus-within{border-color:rgba(16,185,129,.45);box-shadow:0 0 0 3px rgba(16,185,129,.07)}
.val-prefix{padding:0 6px 0 14px;font-family:"DM Mono",monospace;font-size:13px;color:var(--t3);flex-shrink:0}
.val-input{flex:1;background:transparent;border:none;padding:11px 14px 11px 2px;font-family:"DM Mono",monospace;font-size:16px;font-weight:500;color:var(--t1);outline:none}

/* Bot√µes footer modal */
.btn-cancel{background:none;border:1px solid var(--border);border-radius:10px;padding:10px 20px;font-size:14px;color:var(--t2);cursor:pointer;font-family:"DM Sans",sans-serif;transition:all .15s}
.btn-cancel:hover{border-color:var(--border-h);color:var(--t1)}
.btn-confirm{background:var(--em);color:#03071a;border:none;border-radius:10px;padding:10px 22px;font-size:14px;font-weight:700;cursor:pointer;font-family:"DM Sans",sans-serif;transition:all .15s;box-shadow:0 4px 12px rgba(16,185,129,.2)}
.btn-confirm:hover{filter:brightness(1.08)}
.btn-danger{background:none;border:1px solid rgba(244,63,94,.3);border-radius:10px;padding:10px 20px;font-size:14px;color:var(--red);cursor:pointer;font-family:"DM Sans",sans-serif;transition:all .15s}
.btn-danger:hover{background:rgba(244,63,94,.08)}

/* ‚îÄ‚îÄ MODAL DELETE ‚îÄ‚îÄ */
.delete-option{display:flex;align-items:flex-start;gap:12px;padding:14px;border:1.5px solid var(--border);border-radius:12px;cursor:pointer;background:var(--s2);transition:all .2s;margin-bottom:10px}
.delete-option:hover{border-color:rgba(244,63,94,.35);background:rgba(244,63,94,.04)}
.delete-option-icon{font-size:22px;flex-shrink:0;margin-top:1px}
.delete-option-title{font-size:13px;font-weight:600;color:var(--t1);margin-bottom:2px}
.delete-option-desc{font-size:12px;color:var(--t2);line-height:1.5}


/* ‚îÄ‚îÄ VALIDA√á√ÉO ‚îÄ‚îÄ */
.modal-input.error, .val-input-wrap.error {
  border-color: rgba(244,63,94,.6) !important;
  box-shadow: 0 0 0 3px rgba(244,63,94,.08) !important;
}
.field-error {
  font-size:11px; color:var(--red); margin-top:4px; display:none;
}
.field-error.show { display:block; }

/* ‚îÄ‚îÄ MODAL CONFIRMA√á√ÉO ‚îÄ‚îÄ */
.confirm-overlay {
  display:none; position:fixed; inset:0; z-index:400;
  background:rgba(3,7,26,.82); backdrop-filter:blur(8px);
  align-items:center; justify-content:center; padding:24px;
}
.confirm-overlay.open { display:flex; }
.confirm-box {
  background:var(--s1); border:1px solid var(--border);
  border-radius:20px; width:100%; max-width:420px;
  padding:32px; animation:modalIn .25s ease both;
}
.confirm-box-icon {
  width:52px; height:52px; border-radius:14px;
  display:flex; align-items:center; justify-content:center;
  font-size:26px; margin-bottom:18px;
}
.confirm-box-title {
  font-family:'Syne',sans-serif; font-size:19px; font-weight:800;
  letter-spacing:-.02em; color:var(--t1); margin-bottom:8px;
}
.confirm-box-desc {
  font-size:13px; color:var(--t2); line-height:1.65; margin-bottom:20px;
}
.confirm-summary-row {
  display:flex; justify-content:space-between; align-items:center;
  font-size:13px; padding:7px 0; border-bottom:1px solid var(--border);
}
.confirm-summary-row:last-child { border-bottom:none; }
.confirm-summary-row span:first-child { color:var(--t3); }
.confirm-summary-row span:last-child { color:var(--t1); font-weight:600; }
.confirm-summary-wrap {
  background:var(--s2); border:1px solid var(--border);
  border-radius:12px; padding:12px 16px; margin-bottom:22px;
}
.confirm-box-actions { display:flex; gap:10px; }
.confirm-box-cancel {
  flex:1; background:none; border:1px solid var(--border);
  border-radius:10px; padding:11px; font-size:14px; color:var(--t2);
  cursor:pointer; font-family:'DM Sans',sans-serif; transition:all .15s;
}
.confirm-box-cancel:hover { border-color:var(--border-h); color:var(--t1); }
.confirm-box-ok {
  flex:2; border:none; border-radius:10px; padding:11px;
  font-size:14px; font-weight:700; cursor:pointer;
  font-family:'DM Sans',sans-serif; transition:all .15s;
}
.confirm-box-ok.green { background:var(--em); color:#03071a; box-shadow:0 4px 12px rgba(16,185,129,.25); }
.confirm-box-ok.green:hover { filter:brightness(1.08); }
.confirm-box-ok.red { background:var(--red); color:#fff; box-shadow:0 4px 12px rgba(244,63,94,.25); }
.confirm-box-ok.red:hover { filter:brightness(1.08); }

/* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
@media(max-width:640px){
  .summary-strip{grid-template-columns:1fr 1fr}
  .freq-grid{grid-template-columns:repeat(2,1fr)}
  .rec-actions{display:none}
  .modal-row{grid-template-columns:1fr}
  .page{padding:20px 16px 60px}
}
</style>
</head>
<body>

<!-- Dev bar -->
<div class="dev-bar">
  <strong>Dev</strong>
  <button class="dev-pill on" id="pill-dark" onclick="setTheme('dark')">Dark</button>
  <button class="dev-pill" id="pill-light" onclick="setTheme('light')">Light</button>
  <div class="dev-sep"></div>
  <button class="dev-pill on" id="pill-foco" onclick="setMode('foco')">Foco</button>
  <button class="dev-pill" id="pill-jornada" onclick="setMode('jornada')">Jornada</button>
  <div class="dev-sep"></div>
  <button class="dev-pill" onclick="openCreate()">+ Nova Recorrente</button>
</div>

<div class="page">

  <!-- HEADER -->
  <div class="page-header">
    <div>
      <div class="page-eyebrow">üí∞ Finan√ßas</div>
      <h1 class="page-title">Transa√ß√µes Recorrentes</h1>
      <p class="page-sub">Despesas e receitas que acontecem automaticamente todo per√≠odo.</p>
    </div>
    <button class="btn-new" onclick="openCreate()">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
      Nova recorrente
    </button>
  </div>

  <!-- FREE LIMIT BANNER -->
  <div class="free-banner">
    <span class="free-banner-icon">‚≠ê</span>
    <div class="free-banner-body">
      <div class="free-banner-title">Voc√™ est√° usando 4 de 5 recorrentes do plano Free</div>
      <div class="free-banner-desc">Assine o PRO para criar recorrentes ilimitadas e nunca perder um lan√ßamento.</div>
    </div>
    <button class="free-banner-cta">Ver PRO</button>
  </div>

  <!-- SUMMARY STRIP -->
  <div class="summary-strip">
    <div class="sum-card">
      <div class="sum-label">Sa√≠da mensal</div>
      <div class="sum-value red">‚àí R$ 847</div>
      <div class="sum-sub">4 despesas ativas</div>
    </div>
    <div class="sum-card">
      <div class="sum-label">Entrada mensal</div>
      <div class="sum-value green">+ R$ 5.000</div>
      <div class="sum-sub">1 receita ativa</div>
    </div>
    <div class="sum-card">
      <div class="sum-label">Impacto l√≠quido</div>
      <div class="sum-value green">+ R$ 4.153</div>
      <div class="sum-sub">por m√™s</div>
    </div>
    <div class="sum-card">
      <div class="sum-label">Custo anual</div>
      <div class="sum-value">R$ 10.164</div>
      <div class="sum-sub">s√≥ em despesas fixas</div>
    </div>
  </div>

  <!-- JORNADA INSIGHT -->
  <div class="jornada-insight">
    <span class="ji-icon">üí°</span>
    <div class="ji-text">
      Suas despesas recorrentes representam <strong>17% da sua renda mensal</strong> ‚Äî isso √© saud√°vel. O pr√≥ximo lan√ßamento √© a <strong>Netflix dia 5</strong>, em 3 dias.
    </div>
  </div>

  <!-- PR√ìXIMAS OCORR√äNCIAS -->
  <div class="upcoming-card">
    <div class="upcoming-title">üìÖ Pr√≥ximas ocorr√™ncias ‚Äî Mar√ßo 2026</div>
    <div class="upcoming-list">
      <div class="upcoming-item">
        <div class="upcoming-date-col"><div class="upcoming-day">01</div><div class="upcoming-month">Mar</div></div>
        <span class="upcoming-icon">üíº</span>
        <div class="upcoming-info"><div class="upcoming-name">Sal√°rio</div><div class="upcoming-freq">Mensal</div></div>
        <span class="upcoming-val income">+ R$ 5.000</span>
      </div>
      <div class="upcoming-item">
        <div class="upcoming-date-col"><div class="upcoming-day">05</div><div class="upcoming-month">Mar</div></div>
        <span class="upcoming-icon">üé¨</span>
        <div class="upcoming-info"><div class="upcoming-name">Netflix</div><div class="upcoming-freq">Mensal</div></div>
        <span class="upcoming-val expense">‚àí R$ 47,90</span>
      </div>
      <div class="upcoming-item">
        <div class="upcoming-date-col"><div class="upcoming-day">10</div><div class="upcoming-month">Mar</div></div>
        <span class="upcoming-icon">üéµ</span>
        <div class="upcoming-info"><div class="upcoming-name">Spotify</div><div class="upcoming-freq">Mensal</div></div>
        <span class="upcoming-val expense">‚àí R$ 21,90</span>
      </div>
      <div class="upcoming-item">
        <div class="upcoming-date-col"><div class="upcoming-day">15</div><div class="upcoming-month">Mar</div></div>
        <span class="upcoming-icon">üí™</span>
        <div class="upcoming-info"><div class="upcoming-name">Academia Smart Fit</div><div class="upcoming-freq">Mensal</div></div>
        <span class="upcoming-val expense">‚àí R$ 99,90</span>
      </div>
      <div class="upcoming-item">
        <div class="upcoming-date-col"><div class="upcoming-day">20</div><div class="upcoming-month">Mar</div></div>
        <span class="upcoming-icon">‚òÅÔ∏è</span>
        <div class="upcoming-info"><div class="upcoming-name">iCloud 50GB</div><div class="upcoming-freq">Mensal</div></div>
        <span class="upcoming-val expense">‚àí R$ 3,50</span>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê MENSAIS ‚ïê‚ïê -->
  <div class="section">
    <div class="section-header">
      <div class="section-label">
        <span class="section-title">Mensais</span>
        <span class="section-count">4 ativas</span>
      </div>
      <span class="section-total">‚àí R$ 847 / m√™s</span>
    </div>
    <div class="rec-list">

      <!-- Sal√°rio -->
      <div class="rec-card">
        <div class="rec-main">
          <div class="rec-icon-wrap" style="background:rgba(16,185,129,.12)">üíº</div>
          <div class="rec-body">
            <div class="rec-name-row">
              <span class="rec-name">Sal√°rio</span>
              <span class="rec-badge badge-income">Receita</span>
            </div>
            <div class="rec-meta">
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                Todo dia 1
              </span>
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                Desde Jan 2025
              </span>
              <span class="rec-meta-item">üè∑Ô∏è Trabalho</span>
            </div>
          </div>
          <div class="rec-right">
            <span class="rec-amount income">+ R$ 5.000</span>
            <div class="rec-actions">
              <button class="rec-btn" onclick="openEditScope('salario')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                Editar
              </button>
              <button class="rec-btn pause-btn" onclick="togglePause(this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                Pausar
              </button>
              <button class="rec-btn delete-btn" onclick="openDelete('salario')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M8 6V4h8v2M19 6l-1 14H6L5 6"/></svg>
                Excluir
              </button>
            </div>
          </div>
        </div>
        <div class="rec-next">
          <span class="rec-next-label">Pr√≥ximo lan√ßamento</span>
          <div style="display:flex;align-items:center;gap:8px">
            <span class="rec-next-date">01 de Mar√ßo de 2026</span>
            <span class="rec-next-countdown">em 7 dias</span>
          </div>
        </div>
      </div>

      <!-- Netflix -->
      <div class="rec-card">
        <div class="rec-main">
          <div class="rec-icon-wrap" style="background:rgba(244,63,94,.1)">üé¨</div>
          <div class="rec-body">
            <div class="rec-name-row">
              <span class="rec-name">Netflix</span>
              <span class="rec-badge badge-expense">Despesa</span>
            </div>
            <div class="rec-meta">
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                Todo dia 5
              </span>
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                Desde Mar 2023
              </span>
              <span class="rec-meta-item">üéÆ Lazer</span>
            </div>
          </div>
          <div class="rec-right">
            <span class="rec-amount expense">‚àí R$ 47,90</span>
            <div class="rec-actions">
              <button class="rec-btn" onclick="openEditScope('netflix')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                Editar
              </button>
              <button class="rec-btn pause-btn" onclick="togglePause(this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                Pausar
              </button>
              <button class="rec-btn delete-btn" onclick="openDelete('netflix')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M8 6V4h8v2M19 6l-1 14H6L5 6"/></svg>
                Excluir
              </button>
            </div>
          </div>
        </div>
        <div class="rec-next">
          <span class="rec-next-label">Pr√≥ximo lan√ßamento</span>
          <div style="display:flex;align-items:center;gap:8px">
            <span class="rec-next-date">05 de Mar√ßo de 2026</span>
            <span class="rec-next-countdown">em 11 dias</span>
          </div>
        </div>
      </div>

      <!-- Spotify -->
      <div class="rec-card">
        <div class="rec-main">
          <div class="rec-icon-wrap" style="background:rgba(16,185,129,.1)">üéµ</div>
          <div class="rec-body">
            <div class="rec-name-row">
              <span class="rec-name">Spotify</span>
              <span class="rec-badge badge-expense">Despesa</span>
            </div>
            <div class="rec-meta">
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                Todo dia 10
              </span>
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                Desde Jun 2022
              </span>
              <span class="rec-meta-item">üéÆ Lazer</span>
            </div>
          </div>
          <div class="rec-right">
            <span class="rec-amount expense">‚àí R$ 21,90</span>
            <div class="rec-actions">
              <button class="rec-btn" onclick="openEditScope('spotify')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                Editar
              </button>
              <button class="rec-btn pause-btn" onclick="togglePause(this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                Pausar
              </button>
              <button class="rec-btn delete-btn" onclick="openDelete('spotify')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M8 6V4h8v2M19 6l-1 14H6L5 6"/></svg>
                Excluir
              </button>
            </div>
          </div>
        </div>
        <div class="rec-next">
          <span class="rec-next-label">Pr√≥ximo lan√ßamento</span>
          <div style="display:flex;align-items:center;gap:8px">
            <span class="rec-next-date">10 de Mar√ßo de 2026</span>
            <span class="rec-next-countdown">em 16 dias</span>
          </div>
        </div>
      </div>

      <!-- Academia ‚Äî pausada -->
      <div class="rec-card paused">
        <div class="rec-main">
          <div class="rec-icon-wrap" style="background:rgba(245,158,11,.1)">üí™</div>
          <div class="rec-body">
            <div class="rec-name-row">
              <span class="rec-name">Academia Smart Fit</span>
              <span class="rec-badge badge-expense">Despesa</span>
              <span class="rec-badge badge-paused">Pausada</span>
            </div>
            <div class="rec-meta">
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                Todo dia 15
              </span>
              <span class="rec-meta-item">ü©∫ Sa√∫de</span>
            </div>
          </div>
          <div class="rec-right">
            <span class="rec-amount expense" style="opacity:.5">‚àí R$ 99,90</span>
            <div class="rec-actions">
              <button class="rec-btn" onclick="openEditScope('academia')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                Editar
              </button>
              <button class="rec-btn pause-btn" onclick="togglePause(this)" style="color:var(--green);border-color:rgba(16,185,129,.3)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                Retomar
              </button>
              <button class="rec-btn delete-btn" onclick="openDelete('academia')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M8 6V4h8v2M19 6l-1 14H6L5 6"/></svg>
                Excluir
              </button>
            </div>
          </div>
        </div>
        <div class="rec-next" style="opacity:.5">
          <span class="rec-next-label">Pausada ‚Äî n√£o vai gerar lan√ßamentos</span>
          <span class="rec-next-date">Retomar para reativar</span>
        </div>
      </div>

    </div>
  </div>

  <!-- ‚ïê‚ïê ANUAIS ‚ïê‚ïê -->
  <div class="section">
    <div class="section-header">
      <div class="section-label">
        <span class="section-title">Anuais</span>
        <span class="section-count">1 ativa</span>
      </div>
      <span class="section-total">‚àí R$ 677,88 / ano</span>
    </div>
    <div class="rec-list">

      <!-- iCloud -->
      <div class="rec-card">
        <div class="rec-main">
          <div class="rec-icon-wrap" style="background:rgba(6,182,212,.1)">‚òÅÔ∏è</div>
          <div class="rec-body">
            <div class="rec-name-row">
              <span class="rec-name">iCloud 50GB ‚Äî Assinatura anual</span>
              <span class="rec-badge badge-expense">Despesa</span>
            </div>
            <div class="rec-meta">
              <span class="rec-meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                Todo dia 20 de Mar√ßo
              </span>
              <span class="rec-meta-item">üìö Tecnologia</span>
            </div>
          </div>
          <div class="rec-right">
            <span class="rec-amount expense">‚àí R$ 677,88</span>
            <div class="rec-actions">
              <button class="rec-btn" onclick="openEditScope('icloud')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                Editar
              </button>
              <button class="rec-btn pause-btn" onclick="togglePause(this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
                Pausar
              </button>
              <button class="rec-btn delete-btn" onclick="openDelete('icloud')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M8 6V4h8v2M19 6l-1 14H6L5 6"/></svg>
                Excluir
              </button>
            </div>
          </div>
        </div>
        <div class="rec-next">
          <span class="rec-next-label">Pr√≥ximo lan√ßamento</span>
          <div style="display:flex;align-items:center;gap:8px">
            <span class="rec-next-date">20 de Mar√ßo de 2026</span>
            <span class="rec-next-countdown" style="color:var(--yellow)">em 26 dias ‚ö†</span>
          </div>
        </div>
      </div>

    </div>
  </div>

</div>

<!-- ‚ïê‚ïê MODAL: Nova / Editar Recorrente ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-create" onclick="closeBg(event,'modal-create')">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="modal-create-title">Nova recorrente</div>
      <div class="modal-sub">Ser√° gerada automaticamente na data configurada a cada per√≠odo.</div>
    </div>
    <div class="modal-body">

      <!-- Tipo -->
      <div class="modal-field">
        <label class="modal-label">Tipo</label>
        <div class="type-toggle">
          <div class="type-btn sel-expense" id="type-exp" onclick="selType('expense')">
            <span class="type-btn-icon">üí∏</span>
            <span class="type-btn-label">Despesa</span>
          </div>
          <div class="type-btn" id="type-inc" onclick="selType('income')">
            <span class="type-btn-icon">üí∞</span>
            <span class="type-btn-label">Receita</span>
          </div>
        </div>
      </div>

      <!-- Nome e valor -->
      <div class="modal-row">
        <div class="modal-field">
          <label class="modal-label">Nome</label>
          <input class="modal-input" type="text" placeholder="Ex: Netflix, Aluguel...">
          <span class="field-error" id="err-name">Nome √© obrigat√≥rio</span>
        </div>
        <div class="modal-field">
          <label class="modal-label">Valor</label>
          <div class="val-input-wrap">
            <span class="val-prefix">R$</span>
            <input class="val-input" type="text" inputmode="numeric" placeholder="0,00" oninput="maskVal(this)">
          </div>
        </div>
      </div>

      <!-- Frequ√™ncia -->
      <div class="modal-field">
        <label class="modal-label">Frequ√™ncia</label>
        <div class="freq-grid">
          <button class="freq-btn" onclick="selFreq(this)">Di√°ria</button>
          <button class="freq-btn" onclick="selFreq(this)">Semanal</button>
          <button class="freq-btn" onclick="selFreq(this)">Quinzenal</button>
          <button class="freq-btn sel" onclick="selFreq(this)">Mensal</button>
          <button class="freq-btn" onclick="selFreq(this)">Bimestral</button>
          <button class="freq-btn" onclick="selFreq(this)">Trimestral</button>
          <button class="freq-btn" onclick="selFreq(this)">Semestral</button>
          <button class="freq-btn" onclick="selFreq(this)">Anual</button>
        </div>
        <span class="field-error" id="err-freq">Selecione uma frequ√™ncia</span>
      </div>

      <!-- Datas -->
      <div class="modal-row">
        <div class="modal-field">
          <label class="modal-label">Data de in√≠cio</label>
          <input class="modal-input" type="date" value="2026-03-01">
          <span class="field-error" id="err-date">Data de in√≠cio √© obrigat√≥ria</span>
        </div>
        <div class="modal-field">
          <label class="modal-label" style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis">Encerramento <span style="color:var(--t3);font-weight:400">(opcional)</span></label>
          <input class="modal-input" type="date" placeholder="Sem encerramento">
        </div>
      </div>

      <!-- Categoria e dia -->
      <div class="modal-row">
        <div class="modal-field">
          <label class="modal-label">Categoria</label>
          <select class="modal-input">
            <option>üéÆ Lazer</option>
            <option>üè† Moradia</option>
            <option>üçΩÔ∏è Alimenta√ß√£o</option>
            <option>üöó Transporte</option>
            <option>ü©∫ Sa√∫de</option>
            <option>üìö Educa√ß√£o</option>
            <option>üíº Trabalho</option>
          </select>
        </div>
        <div class="modal-field">
          <label class="modal-label">Dia do m√™s</label>
          <input class="modal-input" type="number" min="1" max="31" placeholder="Ex: 5" value="5">
        </div>
      </div>

      <!-- Observa√ß√µes -->
      <div class="modal-field">
        <label class="modal-label">Observa√ß√µes <span style="color:var(--t3);font-weight:400">(opcional)</span></label>
        <input class="modal-input" type="text" placeholder="Ex: Plano fam√≠lia, cart√£o Nubank...">
      </div>

    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeModal('modal-create')">Cancelar</button>
      <button class="btn-confirm" onclick="trySave()">Salvar recorrente</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL: Editar ‚Äî afeta futuras ou todas? ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-edit-scope" onclick="closeBg(event,'modal-edit-scope')">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Editar recorrente</div>
      <div class="modal-sub">Esta altera√ß√£o j√° tem lan√ßamentos passados gerados. Como deseja aplicar a edi√ß√£o?</div>
    </div>
    <div class="modal-body">
      <div class="delete-option" onclick="applyEdit('future')">
        <span class="delete-option-icon">üîÆ</span>
        <div>
          <div class="delete-option-title">Somente lan√ßamentos futuros</div>
          <div class="delete-option-desc">Os lan√ßamentos j√° gerados no extrato n√£o ser√£o alterados. Apenas os pr√≥ximos seguir√£o o novo valor.</div>
        </div>
      </div>
      <div class="delete-option" onclick="applyEdit('all')">
        <span class="delete-option-icon">üìã</span>
        <div>
          <div class="delete-option-title">Todos ‚Äî futuros e passados</div>
          <div class="delete-option-desc">Atualiza tamb√©m os lan√ßamentos j√° gerados no extrato. Use com aten√ß√£o: pode alterar o hist√≥rico financeiro.</div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeModal('modal-edit-scope')">Cancelar</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê MODAL: Excluir ‚ïê‚ïê -->
<div class="modal-overlay" id="modal-delete" onclick="closeBg(event,'modal-delete')">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Excluir recorrente</div>
      <div class="modal-sub">Esta recorrente j√° gerou lan√ßamentos. O que deseja excluir?</div>
    </div>
    <div class="modal-body">
      <div class="delete-option" onclick="confirmDelete('future')">
        <span class="delete-option-icon">‚è≠Ô∏è</span>
        <div>
          <div class="delete-option-title">Somente os futuros</div>
          <div class="delete-option-desc">Cancela os pr√≥ximos lan√ßamentos, mas mant√©m o hist√≥rico de transa√ß√µes passadas no extrato.</div>
        </div>
      </div>
      <div class="delete-option" onclick="confirmDelete('all')">
        <span class="delete-option-icon">üóëÔ∏è</span>
        <div>
          <div class="delete-option-title">Excluir tudo ‚Äî futuros e hist√≥rico</div>
          <div class="delete-option-desc">Remove a recorrente e todos os lan√ßamentos gerados. Esta a√ß√£o n√£o pode ser desfeita.</div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-cancel" onclick="closeModal('modal-delete')">Cancelar</button>
    </div>
  </div>
</div>

<script>
function setTheme(t){
  document.body.classList.toggle('light', t==='light');
  document.getElementById('pill-dark').classList.toggle('on', t==='dark');
  document.getElementById('pill-light').classList.toggle('on', t==='light');
}
function setMode(m){
  document.body.classList.toggle('jornada', m==='jornada');
  document.getElementById('pill-foco').classList.toggle('on', m==='foco');
  document.getElementById('pill-jornada').classList.toggle('on', m==='jornada');
}
function openModal(id){ document.getElementById(id).classList.add('open'); }
function closeModal(id){ document.getElementById(id).classList.remove('open'); }
function closeBg(e,id){ if(e.target===document.getElementById(id)) closeModal(id); }


const recData = {
  salario:  { type:'income',  name:'Sal√°rio',                  val:'5.000,00', freq:'Mensal',    startDate:'2025-01-01', endDate:'', cat:'üíº Trabalho',    day:'1',  obs:'' },
  netflix:  { type:'expense', name:'Netflix',                  val:'47,90',    freq:'Mensal',    startDate:'2023-03-05', endDate:'', cat:'üéÆ Lazer',       day:'5',  obs:'Plano fam√≠lia' },
  spotify:  { type:'expense', name:'Spotify',                  val:'21,90',    freq:'Mensal',    startDate:'2022-06-10', endDate:'', cat:'üéÆ Lazer',       day:'10', obs:'' },
  academia: { type:'expense', name:'Academia Smart Fit',       val:'99,90',    freq:'Mensal',    startDate:'2024-01-15', endDate:'', cat:'ü©∫ Sa√∫de',       day:'15', obs:'Plano Black' },
  icloud:   { type:'expense', name:'iCloud 50GB ‚Äî Anual',      val:'677,88',   freq:'Anual',     startDate:'2025-03-20', endDate:'', cat:'üìö Tecnologia',  day:'20', obs:'Renova√ß√£o autom√°tica' },
};

// ‚îÄ‚îÄ Estado atual do modal ‚îÄ‚îÄ
let currentEditKey = null; // null = criar novo
let currentDeleteScope = null;
let currentDeleteKey = null;

// ‚îÄ‚îÄ Abrir criar ‚îÄ‚îÄ
function openCreate(){
  currentEditKey = null;
  document.getElementById('modal-create-title').textContent = 'Nova recorrente';
  resetForm();
  openModal('modal-create');
}

// ‚îÄ‚îÄ Abrir editar ‚Äî popula o form com dados reais ‚îÄ‚îÄ
function openEdit(key){
  currentEditKey = key;
  const d = recData[key];
  if(!d) return;

  document.getElementById('modal-create-title').textContent = 'Editar recorrente';
  resetForm();

  // Tipo
  selType(d.type);

  // Nome
  document.querySelector('#modal-create .modal-input[placeholder*="Netflix"]').value = d.name;

  // Valor
  document.querySelector('#modal-create .val-input').value = d.val;

  // Frequ√™ncia
  document.querySelectorAll('.freq-btn').forEach(b => {
    b.classList.toggle('sel', b.textContent.trim() === d.freq);
  });

  // Datas
  const dateInputs = document.querySelectorAll('#modal-create input[type=date]');
  if(dateInputs[0]) dateInputs[0].value = d.startDate;
  if(dateInputs[1]) dateInputs[1].value = d.endDate;

  // Categoria
  const catSel = document.querySelector('#modal-create select.modal-input');
  if(catSel){
    Array.from(catSel.options).forEach(o => {
      if(o.text.includes(d.cat.split(' ')[1])) catSel.value = o.value;
    });
  }

  // Dia do m√™s
  const dayInput = document.querySelector('#modal-create input[type=number]');
  if(dayInput) dayInput.value = d.day;

  // Observa√ß√µes
  const obsInput = document.querySelector('#modal-create input[placeholder*="Plano fam√≠lia"]');
  if(obsInput) obsInput.value = d.obs;

  closeModal('modal-edit-scope');
  openModal('modal-create');
}

function applyEdit(scope){
  closeModal('modal-edit-scope');
  openEdit(currentEditKey || 'netflix');
}

// ‚îÄ‚îÄ Reset form ‚îÄ‚îÄ
function resetForm(){
  selType('expense');
  document.querySelectorAll('#modal-create .modal-input').forEach(i => {
    if(i.tagName === 'INPUT' && i.type !== 'date') i.value = '';
    if(i.tagName === 'SELECT') i.selectedIndex = 0;
  });
  document.querySelector('#modal-create .val-input').value = '';
  const dateInputs = document.querySelectorAll('#modal-create input[type=date]');
  if(dateInputs[0]) dateInputs[0].value = '2026-03-01';
  if(dateInputs[1]) dateInputs[1].value = '';
  const dayInput = document.querySelector('#modal-create input[type=number]');
  if(dayInput) dayInput.value = '5';
  document.querySelectorAll('.freq-btn').forEach((b,i) => b.classList.toggle('sel', i===3));
  clearErrors();
}

// ‚îÄ‚îÄ Valida√ß√£o ‚îÄ‚îÄ
function clearErrors(){
  document.querySelectorAll('.modal-input.error, .val-input-wrap.error').forEach(el => el.classList.remove('error'));
  document.querySelectorAll('.field-error.show').forEach(el => el.classList.remove('show'));
}

function validateForm(){
  clearErrors();
  let ok = true;

  const nameInput = document.querySelector('#modal-create .modal-input[placeholder*="Netflix"]');
  const nameErr   = document.getElementById('err-name');
  if(!nameInput.value.trim()){
    nameInput.classList.add('error');
    if(nameErr) nameErr.classList.add('show');
    ok = false;
  }

  const valInput = document.querySelector('#modal-create .val-input');
  const valWrap  = valInput.closest('.val-input-wrap');
  const valErr   = document.getElementById('err-val');
  if(!valInput.value || valInput.value === '0,00'){
    valWrap.classList.add('error');
    if(valErr) valErr.classList.add('show');
    ok = false;
  }

  const dateInput = document.querySelector('#modal-create input[type=date]');
  const dateErr   = document.getElementById('err-date');
  if(!dateInput.value){
    dateInput.classList.add('error');
    if(dateErr) dateErr.classList.add('show');
    ok = false;
  }

  const freqSel = document.querySelector('.freq-btn.sel');
  const freqErr = document.getElementById('err-freq');
  if(!freqSel){
    if(freqErr) freqErr.classList.add('show');
    ok = false;
  }

  return ok;
}

// ‚îÄ‚îÄ Salvar (abre confirma√ß√£o) ‚îÄ‚îÄ
function trySave(){
  if(!validateForm()) return;

  const name  = document.querySelector('#modal-create .modal-input[placeholder*="Netflix"]').value;
  const val   = document.querySelector('#modal-create .val-input').value;
  const freq  = document.querySelector('.freq-btn.sel')?.textContent.trim() || '‚Äî';
  const type  = document.getElementById('type-exp').classList.contains('sel-expense') ? 'Despesa' : 'Receita';
  const cat   = document.querySelector('#modal-create select.modal-input')?.options[document.querySelector('#modal-create select.modal-input').selectedIndex]?.text || '‚Äî';
  const day   = document.querySelector('#modal-create input[type=number]')?.value || '‚Äî';

  const isEdit = currentEditKey !== null;
  document.getElementById('conf-save-title').textContent = isEdit ? 'Confirmar edi√ß√£o?' : 'Confirmar cria√ß√£o?';
  document.getElementById('conf-save-desc').textContent  = isEdit
    ? 'Os pr√≥ximos lan√ßamentos seguir√£o os dados abaixo.'
    : 'A recorrente ser√° gerada automaticamente a cada per√≠odo configurado.';

  document.getElementById('conf-save-summary').innerHTML = `
    <div class="confirm-summary-row"><span>Nome</span><span>${name}</span></div>
    <div class="confirm-summary-row"><span>Tipo</span><span>${type}</span></div>
    <div class="confirm-summary-row"><span>Valor</span><span>R$ ${val}</span></div>
    <div class="confirm-summary-row"><span>Frequ√™ncia</span><span>${freq}</span></div>
    <div class="confirm-summary-row"><span>Categoria</span><span>${cat}</span></div>
    <div class="confirm-summary-row"><span>Dia do m√™s</span><span>${day}</span></div>
  `;

  document.getElementById('conf-save').classList.add('open');
}

function finalizeSave(){
  document.getElementById('conf-save').classList.remove('open');
  closeModal('modal-create');
}

// ‚îÄ‚îÄ Excluir ‚îÄ‚îÄ
function openDelete(key){
  currentDeleteKey = key || 'netflix';
  openModal('modal-delete');
}

function confirmDelete(scope){
  currentDeleteScope = scope;
  closeModal('modal-delete');

  const key = currentDeleteKey;
  const d = recData[key] || { name: 'esta recorrente' };
  const scopeLabel = scope === 'future' ? 'Somente lan√ßamentos futuros' : 'Tudo ‚Äî futuros e hist√≥rico';

  document.getElementById('conf-delete-desc').textContent =
    scope === 'future'
      ? 'Os lan√ßamentos passados ser√£o mantidos no extrato. Somente os pr√≥ximos ser√£o cancelados.'
      : 'Todos os lan√ßamentos gerados e a recorrente ser√£o removidos permanentemente.';

  document.getElementById('conf-delete-summary').innerHTML = `
    <div class="confirm-summary-row"><span>Recorrente</span><span>${d.name}</span></div>
    <div class="confirm-summary-row"><span>Escopo</span><span>${scopeLabel}</span></div>
  `;

  document.getElementById('conf-delete').classList.add('open');
}

function finalizeDelete(){
  document.getElementById('conf-delete').classList.remove('open');
}

// ‚îÄ‚îÄ Editar escopo ‚îÄ‚îÄ
function openEditScope(key){
  currentEditKey = key;
  openModal('modal-edit-scope');
}

function togglePause(btn){
  const card = btn.closest('.rec-card');
  const isPaused = card.classList.toggle('paused');
  if(isPaused){
    btn.innerHTML = '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg> Retomar';
    btn.style.color = 'var(--green)'; btn.style.borderColor = 'rgba(16,185,129,.3)';
    const nr = card.querySelector('.rec-name-row');
    if(nr && !nr.querySelector('.badge-paused')){
      const b=document.createElement('span'); b.className='rec-badge badge-paused'; b.textContent='Pausada'; nr.appendChild(b);
    }
  } else {
    btn.innerHTML = '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg> Pausar';
    btn.style.color=''; btn.style.borderColor='';
    const b=card.querySelector('.badge-paused'); if(b) b.remove();
  }
}

function selType(t){
  document.getElementById('type-exp').className = 'type-btn' + (t==='expense' ? ' sel-expense' : '');
  document.getElementById('type-inc').className = 'type-btn' + (t==='income'  ? ' sel-income'  : '');
}
function selFreq(btn){
  document.querySelectorAll('.freq-btn').forEach(b => b.classList.remove('sel'));
  btn.classList.add('sel');
}
function maskVal(input){
  let v = input.value.replace(/\D/g,'');
  if(!v){ input.value=''; return; }
  const num = (parseInt(v,10)/100).toFixed(2);
  const [int,dec] = num.split('.');
  input.value = int.replace(/\B(?=(\d{3})+(?!\d))/g,'.')+','+dec;
}
</script>

<!-- ‚ïê‚ïê CONFIRMA√á√ÉO: Salvar (criar/editar) ‚ïê‚ïê -->
<div class="confirm-overlay" id="conf-save" onclick="if(event.target===this)this.classList.remove('open')">
  <div class="confirm-box">
    <div class="confirm-box-icon" style="background:rgba(16,185,129,.1)">üíæ</div>
    <div class="confirm-box-title" id="conf-save-title">Confirmar cria√ß√£o?</div>
    <p class="confirm-box-desc" id="conf-save-desc">Revise os dados antes de salvar. A recorrente ser√° gerada automaticamente a cada per√≠odo configurado.</p>
    <div class="confirm-summary-wrap" id="conf-save-summary"></div>
    <div class="confirm-box-actions">
      <button class="confirm-box-cancel" onclick="document.getElementById('conf-save').classList.remove('open')">Revisar</button>
      <button class="confirm-box-ok green" onclick="finalizeSave()">Salvar recorrente</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê CONFIRMA√á√ÉO: Excluir ‚ïê‚ïê -->
<div class="confirm-overlay" id="conf-delete" onclick="if(event.target===this)this.classList.remove('open')">
  <div class="confirm-box">
    <div class="confirm-box-icon" style="background:rgba(244,63,94,.1)">üóëÔ∏è</div>
    <div class="confirm-box-title">Confirmar exclus√£o?</div>
    <p class="confirm-box-desc" id="conf-delete-desc">Esta a√ß√£o n√£o pode ser desfeita.</p>
    <div class="confirm-summary-wrap" id="conf-delete-summary"></div>
    <div class="confirm-box-actions">
      <button class="confirm-box-cancel" onclick="document.getElementById('conf-delete').classList.remove('open')">Cancelar</button>
      <button class="confirm-box-ok red" id="conf-delete-ok" onclick="finalizeDelete()">Excluir</button>
    </div>
  </div>
</div>

</body>
</html>